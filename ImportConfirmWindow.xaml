<Window
    x:Class="GB_NewCadPlus_III.Views.ImportConfirmWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:GB_NewCadPlus_III"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    Title="确认导入图元"
    Width="900"
    Height="700"
    WindowStartupLocation="CenterOwner"
    mc:Ignorable="d">
    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <!--  引用外部样式资源文件  -->
                <ResourceDictionary Source="/GB_NewCadPlus_III;component/MainWindowStyleDictionary.xaml" />
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </Window.Resources>
    <Grid Margin="10">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="320" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>

        <!--  左侧：预览和操作  -->
        <DockPanel Grid.Column="0" Margin="0,0,10,0">
            <TextBlock
                Margin="0,0,0,5"
                DockPanel.Dock="Top"
                FontWeight="Bold"
                Text="图元预览" />
            <StackPanel
                Margin="0,10,0,0"
                DockPanel.Dock="Bottom"
                Orientation="Vertical">
                <Button
                    x:Name="BtnPastePreview"
                    Width="128"
                    Margin="0,0,0,5"
                    Padding="5"
                    Content="从剪贴板粘贴预览图" />
                <Button
                    x:Name="BtnExportTemplate"
                    Width="128"
                    Padding="5"
                    Content="导出为Excel模板" />
            </StackPanel>
            <Border BorderBrush="Gray" BorderThickness="1">
                <Image x:Name="PreviewImage" Stretch="Uniform" />
            </Border>
        </DockPanel>

        <!--  右侧：属性编辑  -->
        <DockPanel Grid.Column="1">
            <TextBlock
                Margin="0,0,0,5"
                DockPanel.Dock="Top"
                FontWeight="Bold"
                Text="图元属性 (可编辑)" />
            <StackPanel
                Margin="0,10,0,0"
                HorizontalAlignment="Right"
                DockPanel.Dock="Bottom"
                Orientation="Horizontal">
                <Button
                    x:Name="BtnConfirm"
                    Width="120"
                    Margin="0,0,10,0"
                    Padding="5"
                    Click="BtnConfirm_Click"
                    Content="确认导入"
                    IsDefault="True" />
                <Button
                    x:Name="BtnCancel"
                    Width="100"
                    Padding="5"
                    Content="取消"
                    IsCancel="True" />
            </StackPanel>
            <DataGrid
                x:Name="PropertiesGrid"
                AutoGenerateColumns="False"
                CanUserAddRows="False"
                ItemsSource="{Binding}">
                <DataGrid.Columns>
                    <DataGridTextColumn
                        Width="80"
                        Binding="{Binding PropertyName1}"
                        Header="属性名"
                        IsReadOnly="True" />
                    <DataGridTextColumn
                        Width="*"
                        Binding="{Binding PropertyValue1}"
                        Header="属性值" />
                    <DataGridTextColumn
                        Width="80"
                        Binding="{Binding PropertyName2}"
                        Header="属性名"
                        IsReadOnly="True" />
                    <DataGridTextColumn
                        Width="*"
                        Binding="{Binding PropertyValue2}"
                        Header="属性值" />
                </DataGrid.Columns>
            </DataGrid>
        </DockPanel>
    </Grid>
</Window>